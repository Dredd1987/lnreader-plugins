var t=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))},e=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Object.defineProperty(exports,"__esModule",{value:!0});var r=require("cheerio"),n=require("@libs/fetch"),o=require("@libs/defaultCover"),i=function(){function i(){this.id="fanfictionnet",this.name="FanFiction.Net",this.version="1.0.0",this.icon="src/en/fanfictionnet/icon.png",this.site="https://www.fanfiction.net"}return i.prototype.parseList=function(t){return t(".z-list").map((function(e,r){var n=t(r).find("a.stitle").text().trim(),i=t(r).find("a.stitle").attr("href");return i?{name:n||"Untitled",path:i.replace(/^\//,""),cover:o.defaultCover}:null})).toArray().filter(Boolean)},i.prototype.popularNovels=function(o,i){return t(this,arguments,void 0,(function(t,o){var i,a,s,c=o.showLatestNovels;return e(this,(function(e){switch(e.label){case 0:return i=c?1:6,[4,(0,n.fetchApi)("".concat(this.site,"/book/?&srt=").concat(i,"&r=10&p=").concat(t))];case 1:return[4,e.sent().text()];case 2:return a=e.sent(),s=(0,r.load)(a),[2,this.parseList(s)]}}))}))},i.prototype.parseNovel=function(i){return t(this,void 0,void 0,(function(){var t,a,s,c,u,l,p,f;return e(this,(function(e){switch(e.label){case 0:return[4,(0,n.fetchApi)(new URL(i,"".concat(this.site,"/")).toString())];case 1:return[4,e.sent().text()];case 2:return t=e.sent(),a=(0,r.load)(t),(s={path:i,name:a("#profile_top > b.xcontrast_txt").text().trim()||"Untitled",cover:o.defaultCover}).author=a('#profile_top a[href*="/u/"]').first().text().trim(),s.summary=a("#profile_top > div.xcontrast_txt").text().trim(),(c=a("#profile_top > span.xgray").text().split("-").map((function(t){return t.trim()})).filter(Boolean)).length>1&&(u=c[1])&&!u.includes("Words:")&&(s.genres=u),(null==(l=c.find((function(t){return t.toLowerCase().includes("status")})))?void 0:l.toLowerCase().includes("complete"))?s.status="Completed":l&&(s.status="Ongoing"),p=[],(f=a("#chap_select option")).length>0?f.each((function(t,e){var r,n=null===(r=a(e).attr("value"))||void 0===r?void 0:r.trim();if(n){var o=a(e).text().replace(/^\d+\.\s*/,"").trim();p.push({name:o||"Chapter ".concat(t+1),path:n.replace(/^\//,""),chapterNumber:t+1})}})):p.push({name:"Chapter 1",path:i,chapterNumber:1}),s.chapters=p.reverse(),[2,s]}}))}))},i.prototype.parseChapter=function(o){return t(this,void 0,void 0,(function(){var t,i;return e(this,(function(e){switch(e.label){case 0:return[4,(0,n.fetchApi)(new URL(o,"".concat(this.site,"/")).toString())];case 1:return[4,e.sent().text()];case 2:return t=e.sent(),[2,(i=(0,r.load)(t))("#storytextp").html()||i("#storytext").html()||""]}}))}))},i.prototype.searchNovels=function(o,i){return t(this,void 0,void 0,(function(){var t,a,s;return e(this,(function(e){switch(e.label){case 0:return t="".concat(this.site,"/search/?")+"keywords=".concat(encodeURIComponent(o),"&ready=1&type=story&p=").concat(i),[4,(0,n.fetchApi)(t)];case 1:return[4,e.sent().text()];case 2:return a=e.sent(),s=(0,r.load)(a),[2,this.parseList(s)]}}))}))},i}();exports.default=new i;